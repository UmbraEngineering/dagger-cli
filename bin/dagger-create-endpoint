#!/usr/bin/env node

require('../lib/utils');

var program = require('commander');

program
	.usage('<name> [options]')
	.option('--for <model>', 'specify the model the endpoint is for')
	.parse(process.argv);

var name = program.args[0];
var model = program.for;

output('Creating new endpoint "' + name + '" for model "' + model + '"...');

var data = {
	endpointName: {
		hyphen: name,
		camel: name.replace(/-([a-z])/g, function(match, letter) {
			return letter.toUpperCase();
		}),
		class: name.replace(/(^|-)([a-z])/g, function(match, start, letter) {
			return letter.toUpperCase();
		})
	},
	modelName: {
		hyphen: model,
		camel: model.replace(/-([a-z])/g, function(match, letter) {
			return letter.toUpperCase();
		}),
		class: model.replace(/(^|-)([a-z])/g, function(match, start, letter) {
			return letter.toUpperCase();
		})
	}
};

var file = 'endpoints/' + data.endpointName.hyphen + '.js';
if (fileExists(file)) {
	output('\n');
	output.error('ERROR: Cannot create endpoint "' + name + '"; File already exists.\n');
	process.exit(1);
	return;
}

renderFromTemplate('endpoints/template.js', file, data);

output(' Done.\n');
